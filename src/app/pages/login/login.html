<div class="login-container">
  <div class="login-box" aria-labelledby="login-title">
    <button type="button" class="btn-back" (click)="volverABienvenida()">
      â† Volver a Bienvenida
    </button>

    <h2 id="login-title">Ingresar al sistema</h2>

    <div class="msg msg--error" *ngIf="errorMessage" aria-live="polite">{{ errorMessage }}</div>
    <div class="msg msg--info" *ngIf="infoMessage" aria-live="polite">{{ infoMessage }}</div>

    <!-- --- ELIMINADO (FAB) ---
      Se quita el contenedor de accesos rÃ¡pidos original.
    -->

    <form [formGroup]="loginForm" (ngSubmit)="login()" novalidate>
      <div class="row">
        <label for="l_email">Correo electrÃ³nico</label>
        <input id="l_email" type="email" formControlName="email" autocomplete="username" />
        <div class="err" *ngIf="loginForm.get('email')?.invalid && loginForm.get('email')?.touched">
          Email invÃ¡lido.
        </div>
      </div>

      <div class="row">
        <label for="l_pass">ContraseÃ±a</label>
        <div class="password-field">
          <input
            id="l_pass"
            [type]="showPassword ? 'text' : 'password'"
            formControlName="password"
            autocomplete="current-password"
          />
          <button
            type="button"
            class="toggle-pass"
            (click)="togglePasswordVisibility()"
            [attr.aria-pressed]="showPassword"
            [attr.aria-label]="showPassword ? 'Ocultar contraseÃ±a' : 'Mostrar contraseÃ±a'"
            title="Mostrar/Ocultar"
          >
            ğŸ‘
          </button>
        </div>
        <div
          class="err"
          *ngIf="loginForm.get('password')?.invalid && loginForm.get('password')?.touched"
        >
          MÃ­nimo 6 caracteres.
        </div>
      </div>

      <div class="row row--inline">
        <label class="remember">
          <input type="checkbox" formControlName="remember" />
          Recordarme en este dispositivo
        </label>
        <button type="button" class="link" (click)="resetPassword()">
          Â¿Olvidaste tu contraseÃ±a?
        </button>
      </div>

      <button type="submit" class="btn-submit" [disabled]="loginForm.invalid || isSubmitting">
        {{ isSubmitting ? 'Ingresando...' : 'Ingresar' }}
      </button>
    </form>

    <div class="resend" *ngIf="showResend">
      <button
        type="button"
        class="btn-resend"
        (click)="reenviarVerificacion()"
        [disabled]="cooldown > 0"
      >
        Reenviar verificaciÃ³n <span *ngIf="cooldown > 0">({{ cooldown }}s)</span>
      </button>
    </div>

    <div class="register-link">Â¿No tenÃ©s cuenta? <a (click)="irARegistro()">Registrate</a></div>
  </div>

  <!-- +++ INICIO CAMBIOS (FAB) +++ -->
  <!--
    Contenedor del BotÃ³n de AcciÃ³n Flotante (FAB) para accesos rÃ¡pidos.
    Se posiciona en la esquina inferior izquierda (ver .scss).
  -->
  <div class="fab-container">
    <!-- Opciones del FAB -->
    <div class="fab-options" [attr.data-open]="isFabOpen">
      <!--
        Iteramos sobre los 6 usuarios definidos en el .ts
        y creamos una opciÃ³n animada para cada uno.
      -->
      <button
        type="button"
        class="fab-option"
        *ngFor="let user of quickAccessUsers; let i = index"
        (click)="accesoRapido(user)"
        [style.transition-delay]="isFabOpen ? i * 0.04 + 's' : (6 - i) * 0.03 + 's'"
      >
        <img
          [src]="user.img"
          [alt]="user.nombre"
          onerror="this.src='https://placehold.co/60x60/cccccc/FFFFFF?text=Err'"
        />
        <span>{{ user.nombre }} ({{ user.rol }})</span>
      </button>
    </div>

    <!-- BotÃ³n principal del FAB -->
    <button
      type="button"
      class="fab-button"
      (click)="toggleFab()"
      title="Accesos RÃ¡pidos"
      [attr.aria-expanded]="isFabOpen"
      aria-label="Mostrar accesos rÃ¡pidos"
    >
      <!-- Usamos la imagen del admin (primer usuario) como Ã­cono principal -->
      <img
        [src]="quickAccessUsers[0].img"
        alt="Acceso RÃ¡pido"
        onerror="this.src='https://placehold.co/60x60/cccccc/FFFFFF?text=A'"
      />
    </button>
  </div>
  <!-- +++ FIN CAMBIOS (FAB) +++ -->
</div>
